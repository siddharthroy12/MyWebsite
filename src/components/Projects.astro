---
import Card from './Card.astro';
import OpenLink from './OpenLink.astro';

const { projects } = Astro.props;
---
<section>
<div class="projects" id="scrollable">
  <div class="box" id="box">
    {projects.map(project => (
    <Card
      title={project['Title']}
      description={project['Description']}
      source={project['Source']}
      live={project['Live']}
    />
    ))}
  </div>
</div>
<div class="container">
  <OpenLink link=""https://github.com/siddharthroy12>View all</OpenLink>
</div>
</section>

<script>
  // Add appropiate padding
  function addPaddingToBox() {
    const box = document.getElementById("box");
    let padding = ((window.innerWidth - (750+(16))) / 2);

    if (window.innerWidth < 750) {
      padding = 16;
    }
    box.style.paddingLeft = padding+'px';
    box.style.paddingRight = padding+'px';
  }

  addPaddingToBox();

  window.addEventListener('resize', addPaddingToBox);

  // Dragable scroll
  const ele = document.getElementById('scrollable');
  let pos = { top: 0, left: 0, x: 0, y: 0 };

  const mouseMoveHandler = function (e) {
    ele.style.cursor = 'grabbing';
    ele.style.userSelect = 'none';
    // How far the mouse has been moved
    const dx = e.clientX - pos.x;
    const dy = e.clientY - pos.y;

    // Scroll the element
    ele.scrollTop = pos.top - dy;
    ele.scrollLeft = pos.left - dx;
  };

  const mouseUpHandler = function () {
    document.removeEventListener('mousemove', mouseMoveHandler);
    document.removeEventListener('mouseup', mouseUpHandler);

    ele.style.cursor = 'grab';
    ele.style.removeProperty('user-select');
  };

  const mouseDownHandler = function (e) {
    pos = {
      // The current scroll
      left: ele.scrollLeft,
      top: ele.scrollTop,
      // Get the current mouse position
      x: e.clientX,
      y: e.clientY,
    };

    document.addEventListener('mousemove', mouseMoveHandler);
    document.addEventListener('mouseup', mouseUpHandler);
  };

  ele.addEventListener('mousedown', mouseDownHandler);

</script>

<style>
  .projects {
    flex: 1;
    display: flex;
    overflow: auto;
    margin-top: 2em;
    padding-bottom: 1em;
    cursor: grab;
    -ms-overflow-style: none;  /* IE and Edge */
    scrollbar-width: none;  /* Firefox */
  }

  .projects::-webkit-scrollbar {
    display: none;
  }

  .gradient {
    position: relative;
  }

  .gradient::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
    right: 0;
    background: linear-gradient(270deg, #161616 0%, rgba(22, 22, 22, 0) 15.6%);
    pointer-events: none;
  }

  .box {
    display: flex;
    min-height: min-content;
  }
</style>

